"use strict";(self.webpackChunktrash_can=self.webpackChunktrash_can||[]).push([[681],{9681:(G,p,i)=>{i.r(p),i.d(p,{AssistantModule:()=>U});var r=i(6895),l=i(433),f=i(5495),t=i(1571),m=i(4427),_=i(5175);const h=["taskId",""];let u=(()=>{class n{constructor(e){this.taskService=e,this.resolve=new t.vpe}ngOnChanges(e){e.taskId&&this.taskId&&(this.task=this.taskService.getTaskById(this.taskId))}resolveEvent(){this.resolve.emit()}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(_.M))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["tc-task-card-for-chat","taskId",""]],inputs:{taskId:"taskId"},outputs:{resolve:"resolve"},standalone:!0,features:[t.TTD,t.jDz],attrs:h,decls:2,vars:3,consts:[[3,"task","resolve"]],template:function(s,o){1&s&&(t.TgZ(0,"tc-task-card",0),t.NdJ("resolve",function(){return o.resolveEvent()}),t.ALo(1,"async"),t.qZA()),2&s&&t.Q6J("task",t.lcZ(1,1,o.task))},dependencies:[r.ez,r.Ov,m.J],encapsulation:2})}return n})();var v=i(7579),d=i(2722),g=i(5261),C=i(4569),x=i(2715),b=i(529);let w=(()=>{class n{constructor(e){this.http=e,this.apiUrl=`${x.N.apiBaseUrl}assistant`}getSuggestion(e){return this.http.post(this.apiUrl,e)}static#t=this.\u0275fac=function(s){return new(s||n)(t.LFG(b.eN))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var M=i(1135);let y=(()=>{class n{constructor(){this.messagesSubject=new M.X([]),this.messages$=this.messagesSubject.asObservable()}addNewMessage(e){this.messagesSubject.next([...this.messagesSubject.getValue(),e])}getHistory(){return this.messagesSubject.getValue()}static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),k=(()=>{class n{set tcShowAssistant(e){this._userRole=e,this.updateView()}constructor(e,s,o){this.templateRef=e,this.viewContainer=s,this.cdRef=o,this.updateView()}updateView(){this._userRole===g.i.Premium||this._userRole===g.i.Mega?this.viewContainer.createEmbeddedView(this.templateRef):this.viewContainer.clear(),this.cdRef.markForCheck()}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(t.Rgc),t.Y36(t.s_b),t.Y36(t.sBO))};static#e=this.\u0275dir=t.lG2({type:n,selectors:[["","tcShowAssistant",""]],inputs:{tcShowAssistant:"tcShowAssistant"},standalone:!0})}return n})(),P=(()=>{class n{set tcAssistantRequested(e){this._userRole=e,this.updateView()}constructor(e,s,o){this.templateRef=e,this.viewContainer=s,this.cdRef=o,this.updateView()}updateView(){this._userRole===g.i.Requested?this.viewContainer.createEmbeddedView(this.templateRef):this.viewContainer.clear(),this.cdRef.markForCheck()}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(t.Rgc),t.Y36(t.s_b),t.Y36(t.sBO))};static#e=this.\u0275dir=t.lG2({type:n,selectors:[["","tcAssistantRequested",""]],inputs:{tcAssistantRequested:"tcAssistantRequested"},standalone:!0})}return n})();function O(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){const c=t.CHM(e).$implicit,$=t.oxw();return t.KtG($.fastPrompt(c.prompt))}),t._uU(1),t.qZA()}if(2&n){const e=a.$implicit;t.xp6(1),t.hij(" ",e.buttonName," ")}}let A=(()=>{class n{constructor(){this.fastPromptEvent=new t.vpe,this.typeYourselfEvent=new t.vpe,this.options=[{buttonName:"In the grocery store",prompt:"I'm in the grocery store right now, what can I do"},{buttonName:"One hour of free time",prompt:"I have one hour of free time, what can I do now"},{buttonName:"Free day",prompt:"I have a free day today"}]}fastPrompt(e){this.fastPromptEvent.emit(e)}typeYourself(){this.typeYourselfEvent.emit()}static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["tc-fast-prompt"]],outputs:{fastPromptEvent:"fastPromptEvent",typeYourselfEvent:"typeYourselfEvent"},decls:7,vars:1,consts:[[1,"tc-fast-track-wrap"],[1,"tc-fast-track"],["class","tc-fast-button",3,"click",4,"ngFor","ngForOf"],[1,"tc-fast-button","tc-fast-chat",3,"click"],[1,"tc-fast-button",3,"click"]],template:function(s,o){1&s&&(t.TgZ(0,"div",0)(1,"p"),t._uU(2,"What's your situation?"),t.qZA(),t.TgZ(3,"div",1),t.YNc(4,O,2,1,"button",2),t.TgZ(5,"button",3),t.NdJ("click",function(){return o.typeYourself()}),t._uU(6," Type yourself "),t.qZA()()()),2&s&&(t.xp6(4),t.Q6J("ngForOf",o.options))},dependencies:[r.sg],styles:[".tc-fast-track-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;min-height:50vh;flex-grow:1;gap:1rem}.tc-fast-track[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:1rem}.tc-fast-track[_ngcontent-%COMP%]   .tc-fast-button[_ngcontent-%COMP%]{padding:.6rem 2rem;border:#000000 1px solid;border-radius:.7rem;font-weight:600;background-color:#fff}.tc-fast-track[_ngcontent-%COMP%]   .tc-fast-chat[_ngcontent-%COMP%]{background-color:#eee;color:#000;border:none;font-weight:500}.tc-fast-track[_ngcontent-%COMP%]   .tc-fast-button[_ngcontent-%COMP%]:hover{background-color:#000;color:#fff;transition:ease-in .3s;cursor:pointer}@media only screen and (min-width: 768px){.tc-fast-track-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-end}.tc-fast-track[_ngcontent-%COMP%]{flex-direction:row;flex-wrap:wrap}.tc-fast-track[_ngcontent-%COMP%]   .tc-fast-button[_ngcontent-%COMP%]{flex-grow:1;min-width:15rem;min-height:5rem;font-size:1rem;flex-shrink:1}.tc-fast-track[_ngcontent-%COMP%]   .tc-fast-chat[_ngcontent-%COMP%]{display:none}}"]})}return n})();const T=["inputMessage"],F=["messagesContainer"];function Z(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(3);return t.KtG(o.onRequestAccess())}),t._uU(1," Request Access "),t.qZA()}}function I(n,a){1&n&&(t.TgZ(0,"div",5),t._uU(1," Your request has been sent. You will be notified when you get access. "),t.qZA())}function Y(n,a){if(1&n&&(t.TgZ(0,"div",4)(1,"div",5),t._uU(2," This is not available to you now. You can request access by clicking the button below. "),t.qZA(),t.YNc(3,Z,2,0,"button",6),t.YNc(4,I,2,0,"div",7),t.qZA()),2&n){const e=t.oxw().ngIf,s=t.oxw();t.xp6(3),t.Q6J("ngIf",e!==s.role.Requested),t.xp6(1),t.Q6J("tcAssistantRequested",e)}}function R(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"tc-fast-prompt",20),t.NdJ("fastPromptEvent",function(o){t.CHM(e);const c=t.oxw(4);return t.KtG(c.onFastButton(o))})("typeYourselfEvent",function(){t.CHM(e);const o=t.oxw(4);return t.KtG(o.onFastType())}),t.qZA()}}function S(n,a){if(1&n&&(t.TgZ(0,"div",26),t._UZ(1,"tc-task-card-for-chat",27),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.Q6J("taskId",e)}}function J(n,a){if(1&n&&(t.TgZ(0,"div",24),t.YNc(1,S,2,1,"div",25),t.qZA()),2&n){const e=t.oxw().$implicit,s=t.oxw(4);t.xp6(1),t.Q6J("ngForOf",s.parseMessage(e).tasks)("ngForTrackBy",s.trackById)}}const N=function(n){return{right:n}},E=function(n){return{user:n}};function B(n,a){if(1&n&&(t.TgZ(0,"div",21)(1,"div",22),t._uU(2),t.qZA(),t.YNc(3,J,2,2,"div",23),t.qZA()),2&n){const e=a.$implicit,s=t.oxw(4);t.Q6J("ngClass",t.VKq(4,N,"user"===e.role)),t.xp6(1),t.Q6J("ngClass",t.VKq(6,E,"user"===e.role)),t.xp6(1),t.hij(" ",s.parseMessage(e).text," "),t.xp6(1),t.Q6J("ngIf",s.parseMessage(e).tasksPresent)}}function q(n,a){if(1&n&&(t.TgZ(0,"div",16,17),t.YNc(2,R,1,0,"tc-fast-prompt",18),t.YNc(3,B,4,8,"div",19),t.qZA()),2&n){const e=a.ngIf,s=t.oxw(3);t.xp6(2),t.Q6J("ngIf",!e.length),t.xp6(1),t.Q6J("ngForOf",e)("ngForTrackBy",s.trackByMessage)}}function j(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",9),t.YNc(1,q,4,3,"div",10),t.ALo(2,"async"),t.TgZ(3,"form",11),t.NdJ("ngSubmit",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.onInput())}),t.TgZ(4,"input",12,13),t.NdJ("ngModelChange",function(o){t.CHM(e);const c=t.oxw(2);return t.KtG(c.inputValue=o)}),t.qZA(),t.TgZ(6,"button",14),t._UZ(7,"img",15),t.qZA()()()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,2,e.messages)),t.xp6(3),t.Q6J("ngModel",e.inputValue)}}function Q(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"div",1),t.YNc(2,Y,5,2,"div",2),t.YNc(3,j,8,4,"div",3),t.qZA(),t.BQk()),2&n){const e=a.ngIf,s=t.oxw();t.xp6(2),t.Q6J("ngIf",e!==s.role.Premium&&e!==s.role.Mega),t.xp6(1),t.Q6J("tcShowAssistant",e)}}const V=[{path:"",component:(()=>{class n{constructor(e,s,o){this.userService=e,this.assistantService=s,this.messageService=o,this.ngUnsubscribe$=new v.x,this.role=g.i,this.inputValue="",this.messages=this.messageService.messages$,this.userRole$=this.userService.userRole$}ngAfterViewChecked(){this.scrollToBottom()}ngOnDestroy(){this.ngUnsubscribe$.next(),this.ngUnsubscribe$.complete()}onRequestAccess(){this.userService.requestAssistantAccess().pipe((0,d.R)(this.ngUnsubscribe$)).subscribe()}trackByMessage(e){return e}trackById(e,s){return s}onInput(){this.inputValue.trim()&&(this.sendMessage({content:this.inputValue.trim(),role:"user"}),this.inputValue="")}onFastButton(e){this.sendMessage({content:e,role:"user"}),this.scrollToBottom()}onFastType(){this.inputMessage.nativeElement.focus()}sendMessage(e){this.messageService.addNewMessage(e),this.assistantService.getSuggestion(this.messageService.getHistory()).pipe((0,d.R)(this.ngUnsubscribe$)).subscribe(s=>{this.messageService.addNewMessage({content:s,role:"assistant"}),this.scrollToBottom()})}parseMessage(e){const s={tasksPresent:!1,text:"",tasks:null};if("user"===e.role)s.text=e.content;else try{const o=JSON.parse(e.content);s.text=o.answerText,s.tasks=o.pickedTasksArray,s.tasksPresent=0!==o.pickedTasksArray.length}catch{s.text=e.content}return s}scrollToBottom(){this.messagesContainer&&(this.messagesContainer.nativeElement.scrollTop=this.messagesContainer.nativeElement.scrollHeight)}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(C.K),t.Y36(w),t.Y36(y))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["tc-assistant"]],viewQuery:function(s,o){if(1&s&&(t.Gf(T,5),t.Gf(F,5)),2&s){let c;t.iGM(c=t.CRH())&&(o.inputMessage=c.first),t.iGM(c=t.CRH())&&(o.messagesContainer=c.first)}},decls:2,vars:3,consts:[[4,"ngIf"],[1,"tc-assistant-page"],["class","tc-assistant-banner",4,"ngIf"],["class","tc-assistant-chat-window",4,"tcShowAssistant"],[1,"tc-assistant-banner"],[1,"tc-assistant-banner-text"],["class","tc-assistant-banner-bt",3,"click",4,"ngIf"],["class","tc-assistant-banner-text",4,"tcAssistantRequested"],[1,"tc-assistant-banner-bt",3,"click"],[1,"tc-assistant-chat-window"],["class","messages",4,"ngIf"],[1,"tc-assistant-form",3,"ngSubmit"],["type","text","name","inputField","placeholder","Message...",3,"ngModel","ngModelChange"],["inputMessage",""],["type","submit"],["src","../../../assets/icons/send-button.svg"],[1,"messages"],["messagesContainer",""],[3,"fastPromptEvent","typeYourselfEvent",4,"ngIf"],["class","tc-message-wrap",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[3,"fastPromptEvent","typeYourselfEvent"],[1,"tc-message-wrap",3,"ngClass"],[1,"message",3,"ngClass"],["class","tc-card-wrap",4,"ngIf"],[1,"tc-card-wrap"],["class","task-message",4,"ngFor","ngForOf","ngForTrackBy"],[1,"task-message"],[3,"taskId"]],template:function(s,o){1&s&&(t.YNc(0,Q,4,2,"ng-container",0),t.ALo(1,"async")),2&s&&t.Q6J("ngIf",t.lcZ(1,1,o.userRole$))},dependencies:[r.mk,r.sg,r.O5,l._Y,l.Fj,l.JJ,l.JL,l.On,l.F,u,k,P,A,r.Ov],styles:[".tc-assistant-page[_ngcontent-%COMP%]{width:100%;height:calc(100vh - 5rem);position:relative;overflow-x:visible}.tc-assistant-page[_ngcontent-%COMP%]   .tc-assistant-chat-window[_ngcontent-%COMP%]{padding:0 1rem;position:relative;height:80vh;display:flex;flex-direction:column;justify-content:flex-end;overflow-x:visible}.tc-assistant-page[_ngcontent-%COMP%]   .tc-assistant-form[_ngcontent-%COMP%]{position:fixed;bottom:5rem;left:.5rem;right:.5rem;display:flex;gap:.5rem;border-radius:.5rem;border:#e0e0e0 1px solid;background-color:#fff}.tc-assistant-page[_ngcontent-%COMP%]   .tc-assistant-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:3rem;padding:.5rem;border:none;flex-grow:1;background:transparent}.tc-assistant-page[_ngcontent-%COMP%]   .tc-assistant-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#828282}.tc-assistant-page[_ngcontent-%COMP%]   .tc-assistant-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active, .tc-assistant-page[_ngcontent-%COMP%]   .tc-assistant-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .tc-assistant-page[_ngcontent-%COMP%]   .tc-assistant-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus-visible{outline-offset:0px;outline:none}.tc-assistant-page[_ngcontent-%COMP%]   .tc-assistant-form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:transparent;padding:0 1rem;border:none;display:flex;align-items:center;justify-content:center}.tc-assistant-page[_ngcontent-%COMP%]   .tc-assistant-form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{cursor:pointer}@media only screen and (min-width: 768px){.tc-assistant-page[_ngcontent-%COMP%]{height:100%;padding:.5rem 5rem}.tc-assistant-page[_ngcontent-%COMP%]   .tc-assistant-form[_ngcontent-%COMP%]{bottom:1rem;left:5rem;right:5rem}}.messages[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;overflow-y:auto;overflow-x:visible}.message[_ngcontent-%COMP%]{border-radius:.5rem;padding:.5rem 1rem;width:-moz-fit-content;width:fit-content;background-color:#e9e9eb;text-wrap:wrap;font-weight:400;max-width:80%}.tc-message-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;gap:1rem}.user[_ngcontent-%COMP%]{background-color:#000;color:#fff}.right[_ngcontent-%COMP%]{display:flex;align-items:flex-end;justify-content:flex-end}.tc-card-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-width:90%;width:-moz-fit-content;width:fit-content}.task-message[_ngcontent-%COMP%]{padding-left:.5rem;padding-bottom:.8rem}.tc-assistant-banner[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;gap:1rem;margin-top:10rem;padding:1rem 2rem;border-radius:.5rem;border:#e0e0e0 1px solid}.tc-assistant-banner-text[_ngcontent-%COMP%]{font-weight:500}.tc-assistant-banner-bt[_ngcontent-%COMP%]{padding:1rem 2rem;border-radius:.5rem;color:#000;background-color:transparent;border:1px #000000 solid;font-weight:600;cursor:pointer;transition:ease-in .3s;text-decoration:none}.tc-assistant-banner-bt[_ngcontent-%COMP%]:hover{background-color:#000;color:#fff;transition:ease-in .3s}"]})}return n})()}];let U=(()=>{class n{static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[r.ez,f.Bz.forChild(V),l.u5,u]})}return n})()}}]);